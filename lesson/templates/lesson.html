{% extends "base.html" %}

{% load staticfiles %}
{% block content %}

<script type="text/javascript">
window.lessonId = {{ lesson.pk }};

$(document).ready(function() {
  $(".nav-tabs a").click(function(e) {
    e.preventDefault();
    $(this).tab('show');
  })
  $('a.unit').tooltip();
})
</script>

<script type="text/javascript" src="{% static 'js/lesson.js' %}" charset="utf-8"></script>


<!-- CONTAINER -->
<div id="course-content" ng-app="lesson">

  <!-- HEADER -->
  {% include "_course-header-inline.html"  with course=lesson.course %}
  <!-- END HEADER -->

  <!-- MAIN CONTENT -->
  <section id="main-content" class="container" ng-controller="LessonMainCtrl">
    <nav class="course-lessons-nav row">
      <div class="col-lg-12 col-sm-12">
        <div class="btn-group button-watching">
          <button type="button" class="btn btn-sm btn-info">{{ lesson.name }}
          </button>
          <button type="button" class="btn btn-sm btn-info dropdown-toggle" data-toggle="dropdown">
            <i class="icon-chevron-down"></i>
          </button>
          <ul class="dropdown-menu">
            {% for list_lesson in lesson.course.public_lessons %}
            <li><a href="{% url 'lesson' list_lesson.slug %}"><span class="title">{{ list_lesson.name }}</span></a></li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </nav>

    <!-- COURSE-VIDEO -->
    <section class="course-video">
      <!-- lesson_video.html -->
      <div class="row">

        {% verbatim %}
        <div class="col-lg-1 col-md-1 col-sm-1 hidden-xs">

          <a style="display:block;" data-placement="right" data-original-title="{{ unit.position + 1 }}"
             title="{{ unit.video.name }}"
             href="#/{{ $index+1 }}" class="has-tooltip unit track" data-toggle="tooltip"
             ng-repeat="unit in lesson.units"
             ng-class="{watching: isSelected($index), done: isDone(unit)}"
             ng-click="select($index)">

            <i class="icon-caret-right" ng-if="isSelected($index)"></i>
            <span class="position">{{ unit.position + 1 }}</span>
            <i class="icon-list" ng-if="unit.activity !== null"></i>
          </a>
        </div>
        <div class="col-xs-12 visible-xs">
          <div class="btn-group button-watching">
            <button type="button" class="btn btn-sm btn-default">Unidade {{ currentUnitPos }}
            </button>
            <button type="button" class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown">
              <i class="icon-chevron-down"></i>
            </button>
            <ul class="dropdown-menu">
              <li ng-repeat="unit in lesson.units">
                <a href="#/{{ $index+1 }}"
                   ng-click="select($index)">
                   <span class="title">Unidade {{ unit.position + 1 }}</span>
                </a>
              </li>
            </ul>
          </div>
          <br/>
          <br/>
        </div>
        {% endverbatim %}

        <div ng-view></div>
      </div>
    </section>

    <div class="row hidden-lg">
        <div class="col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
            <section class="course-instructions">
              <div class="page-header-double">
                <h3><i class="icon-double-angle-right"></i> Notas do professor</h3>
              </div>
              {{ lesson.notes|safe }}
            </section>
        </div>
    </div>

  <!-- END COURSE-VIDEO -->

  <!-- FORUM -->
  <div class="row">
    {% include "_forum_inline.html"  with course=lesson.course %}
    <div class="col-lg-3 hidden-md hidden-sm">
      <section class="course-instructions">
        <div class="page-header-double">
          <h3><i class="icon-double-angle-right"></i> Notas do professor</h3>
        </div>
        {{ lesson.notes|safe }}
      </section>

      <section class="course-social" style="position:relative;overflow:hidden;">
      </section>
    </div>
  </div>
  <!-- END FORUM -->

</section>
<!-- END MAIN CONTENT -->
</div>
<!-- CONTAINER -->
{% endblock %}
