<!DOCTYPE html>
<html ng-app="admin">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="cache-control" content="no-cache"/>
  <meta http-equiv="pragma" content="no-cache"/>
  <meta http-equiv="expires" content="-1"/>

  <title>{{ course }}</title>

  <script src="//www.youtube.com/iframe_api"></script>

  {% include "_assets.html" with admin=True %}
  {% load staticfiles %}

  <script type="text/javascript" src="{% static 'js/directives/contenteditable.js' %}" charset="utf-8"></script>
  <script type="text/javascript" src="{% static 'js/directives/markdowneditor.js' %}" charset="utf-8"></script>
  <script type="text/javascript" src="{% static 'js/admin.js' %}" charset="utf-8"></script>
</head>
<body id="admin" ng-controller="CourseEdit">

  <!-- NAVBAR -->
  <div id="main-navbar" class="navbar navbar-inverse">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">TIMTec</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="main-navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                {% comment %}
                <li><a href="/admin/courses">Cursos</a></li>
                <li><a href="/admin/users">Usuários</a></li>
                <li><a href="/admin/stats">Estatísticas</a></li>
                {% endcomment %}
                <li class="divider"></li>
                <li><a href="/">TIMTec</a></li>
                <li class="divider"></li>
                <li><a href="/admin/profile">timtect@timtec.com.br</a></li>
            </ul>
        </div>
      </div>
  </div>
  <!-- END NAVBAR -->


  <!-- WRAPPER -->
  <div class="wrapper">
    <!-- CONTAINER -->
    <div id="course-content" class="course-intro">
      <!-- HEADER -->
      <header id="main-header" class="container">
        <div class="page-header">
          <div class="row">
            <div class="col-sm-9 col-lg-9">
              <h1 class="top editable"><span contenteditable="true" ng-model="course.name" ng-blur="course.$save()"></span></h1>
              <h5><span class="icon-addable fa fa-plus-square"></span> Adicionar professores ao curso</h5>
              <h5>
                <span>Marcar curso como:</span>
                <select ng-model="course.status" ng-change="course.$save()">
                  <option value="draft">Rascunho</option>
                  <option value="listed">Listado</option>
                  <option value="published">Publicado</option>
                </select>
              </h5>
            </div>
            <div class="col-sm-3 col-lg-3 textright">
                <!-- COURSE-SECTION-NAV -->
              <nav class="course-sections textright">
                <a href="{% url 'course_admin' course.slug %}"><span class="has-tooltip icon-home" data-toggle="tooltip" data-placement="top" data-original-title="Intro"></span></a>
                <a href="{% url 'course_material_admin' course.slug %}"><span class="has-tooltip icon-exclamation-sign" data-toggle="tooltip" data-placement="top" data-original-title="Material Didádico"></span></a>
              </nav>
              <!-- END COURSE-SECTION-NAV -->
            </div>
          </div>
        </div>
      </header>
      <!-- END HEADER -->

      <!-- MAIN CONTENT -->
      <section id="main-content" class="container">
        <div class="row">
          <div class="col-sm-9 col-lg-9">
            <section class="course-video top row">

              <div class="col-lg-12">
                <div ng-show="video.youtube_id">
                  {% verbatim %}
                  <div id="youtube-player" youtube-player></div>
                  {% endverbatim %}
                  <button ng-click="video.youtube_id=null" class="btn btn-danger btn-lg uppercase">Alterar vídeo</button>
                </div>
                <div class="add-video-intro col-sm-12 col-lg-12 left right textcenter" ng-hide="video.youtube_id">
                  <div class="centered">
                    <i class="fa fa-youtube-play"></i>
                    <h1 class="top">Vídeo de introdução</h1>
                    <p class="form-group">
                        <input type="text" class="form-control" ng-model="video.youtube_id_temp"/>
                    </p>
                    <p>
                        <button ng-click="video.reset()" ng-show="course.intro_video.youtube_id" class="btn btn-danger btn-lg uppercase">Cancelar</button>
                        <button ng-click="video.save()" class="btn btn-success btn-lg uppercase">Adicionar</button>
                    </p>
                  </div>
                </div>
              </div>
            </section>


            <section class="course-info row">
              <div class="col-sm-6 col-lg-6">
                <div class="page-header-double">
                  <h3 class="top"><i class="fa fa-angle-double-right"></i> Aplicação do Conhecimento</h3>
                </div>
                <modalmarkdowneditor title="Aplicação do conhecimento" content="course.application" save="saveCourse"></modalmarkdowneditor>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="page-header-double">
                  <h3 class="top"><i class="fa fa-angle-double-right"></i> O que preciso saber</h3>
                </div>
                <modalmarkdowneditor title="O que preciso saber" content="course.requirement" save="saveCourse"></modalmarkdowneditor>
              </div>
            </section>


            <section class="course-lessons row" ng-controller="LessonList">
              <div class="col-sm-12 col-lg-12">
                <div class="page-header-double">
                  <h3><i class="fa fa-angle-double-right"></i> Aulas</h3>
                </div>

                <a href="#lessonModal" ng-click="newLesson()"
                   data-toggle="modal" class="btn btn-success">Adicionar</a>

                {% verbatim %}
                <ul class="no-bullet">
                  <li ng-repeat="lesson in lessons">
                    <div class="row">
                      <div class="col-lg-3 col-sm-3">
                        <img src="/static/img/lesson-default.png" class="img-thumbnail">
                      </div>
                      <div class="col-lg-9 col-sm-9">
                        <p>

                          <!-- lesson selector -->
                          <a href="#lessonModal" data-toggle="modal" class="title"
                             ng-click="select(lesson)">{{ lesson.name }}</a>
                             <p]>
                             <a href="/lesson/{{ lesson.slug }}" target="_blank">Visualizar</a>
                             </p>

                          <span class="description">{{ lesson.desc }}</span>
                        </p>
                        <table class="table">
                          <tr>
                            <td ng-repeat="unit in lesson.units">
                              <span class="has-tooltip unit" data-toggle="tooltip" data-placement="bottom" data-original-title="Unidade {{ $index }}">&nbsp;<i ng-show="unit.activity" class="icon-list"></i></span>
                            </td>
                          </tr>
                        </table>
                        <p><i class="fa fa-youtube-play"></i> <small>{{ countVideos(lesson) }} vídeos</small> | <i class="fa fa-list"></i> <small>{{ countActivities(lesson) }} atividades</small></p>
                      </div>
                    </div>
                  </li>
                </ul>
                {% endverbatim %}
              </div>
            </section>

            <section class="course-instructors row">
              <div class="col-sm-12 col-lg-12">
                <div class="page-header-double">
                  <h3><i class="fa fa-angle-double-right"></i> Professores</h3>
                </div>
                <a href="#professorModal" data-toggle="modal" class="btn btn-success">Adicionar</a>
              </div>

              <br/>{# TODO: resolver esse <br/> (anderson) #}

              {% verbatim %}
              <div ng-repeat="professor in course.professors" class="col-sm-12 col-lg-12">
                <div id="{{ professor.user.username }}" class="instructor row">
                  <div class="col-sm-3 col-lg-3">
                    <img ng-src="{{professor.user.picture}}" class="img-thumbnail">
                  </div>
                  <div class="col-sm-9 col-lg-9">
                    <h1 class="fullname bottom top">{{ professor.user.name }}</h1>
                    <h2 class="job-title top">{{ professor.role }}</h2>
                    <p>{{ professor.biography }}</p>
                  </div>
                </div>
              </div>
              {% endverbatim %}
            </section>
          </div>

          <div class="col-sm-3 col-lg-3">
            <div class="row">
              <section class="course-summary col-sm-12 col-lg-12">
                <div class="page-header-double top">
                  <h3 class="top"><i class="fa fa-angle-double-right"></i> Resumo</h3>
                </div>
                <modalmarkdowneditor title="Resumo" content="course.abstract" save="saveCourse"></modalmarkdowneditor>
                <hr/>

                <div class="page-header-double top">
                  <h3 class="top"><i class="fa fa-angle-double-right"></i> Estrutura do curso</h3>
                </div>
                <modalmarkdowneditor title="Estrutura do curso" content="course.structure" save="saveCourse"></modalmarkdowneditor>
                <hr/>

                <div class="page-header-double top">
                  <h3 class="top"><i class="fa fa-angle-double-right"></i> Carga horária</h3>
                </div>
                <modalmarkdowneditor title="Carga horária" content="course.workload" save="saveCourse"></modalmarkdowneditor>
                <hr/>
              </section>

              <section class="course-social col-sm-12 col-lg-12" style="position:relative;overflow:hidden;">
              </section>
            </div>
          </div>
        </div>
      </section>
      <!-- END MAIN CONTENT -->
    </div>
    <!-- END CONTAINER -->
  </div>
  <!-- END WRAPPER -->



  <!-- FOOTER -->
  {% include 'footer.html' %}
  <!-- END FOOTER -->

  <div class="modal professor-modal fade" id="professorModal" tabindex="-1" role="dialog" aria-labelledby="professorModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Adicionar Professor</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-lg-4">
              <p class="form-group"><input type="search" class="form-control col-lg-12" placeholder="Procurar professor"></p>
              <ul class="contacts">
                <li class="title">A</li>
                <li>Anderson Orui</li>
                <li class="title">B</li>
                <li>Bruno Martin</li>
                <li class="title">C</li>
                <li>Cátia Kitahara</li>
                <li class="title">D</li>
                <li class="title">E</li>
                <li class="title">F</li>
                <li>Fábio Montefuscolo</li>
                <li class="title">G</li>
                <li class="title">H</li>
                <li class="title">I</li>
                <li class="title">J</li>
                <li class="title">K</li>
                <li class="title">L</li>
                <li class="title">M</li>
                <li class="title">N</li>
                <li class="title">O</li>
                <li class="title">P</li>
                <li class="title">Q</li>
                <li class="title">R</li>
                <li class="title">S</li>
                <li class="title">T</li>
                <li class="title">U</li>
                <li class="title">V</li>
                <li class="title">X</li>
                <li class="title">W</li>
                <li class="title">Y</li>
                <li class="title">Z</li>
              </ul>
            </div>
            <div class="col-lg-8">
              <form>
                <div class="form-group">
                  <label>Nome do professor</label>
                  <input type="text" class="form-control col-lg-12" placeholder="Nome do professor">
                </div>
                <div class="form-group">
                  <label>Biografia</label>
                  <div class="text-editor">
                    <div class="row">
                      <div class="col-lg-12">
                        <i class="icon-bold"></i>
                        <i class="icon-italic"></i>
                        <i class="icon-link"></i>
                        <i class="icon-quote-left"></i>
                        <i class="icon-code"></i>
                        <i class="icon-list-ol"></i>
                        <i class="icon-align-left"></i>
                        <i class="icon-align-center"></i>
                        <i class="icon-align-right"></i>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-lg-12">
                        <textarea class="col-lg-12 form-control" rows="15"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% verbatim %}
  <div class="modal lesson-modal fade" id="lessonModal" ng-controller="LessonEdit"
       tabindex="-1" role="dialog" aria-labelledby="lessonModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" ng-hide="selectedLesson.name">Adicionar Aula</h4>
          <h4 class="modal-title" ng-show="selectedLesson.name">{{selectedLesson.name}}</h4>
        </div>
        <div class="modal-body">
          <div class="main-lesson-content row" ng-show="active=='content'">
            <div class="col-lg-12">
              <div class="form-group">
                <label>Título</label>
                <input type="text" class="form-control"
                       placeholder="Título da aula" ng-model="selectedLesson.name">
              </div>
              <div class="form-group">
                <label>Status:</label>&nbsp;
                <label for="lesson-status-draft">Rascunho</label>
                <input type="radio" id="lesson-status-draft" value="draft" ng-model="selectedLesson.status">
                &nbsp;&nbsp;&nbsp;
                <label for="lesson-status-listed">Listado</label>
                <input type="radio" id="lesson-status-listed" value="listed"  ng-model="selectedLesson.status">
                &nbsp;&nbsp;&nbsp;
                <label for="lesson-status-published">Publicado</label>
                <input type="radio" id="lesson-status-published" value="published"  ng-model="selectedLesson.status">
              </div>

              <div class="form-group">
                <label>Descrição</label>
                <textarea class="col-lg-12 form-control" ng-model="selectedLesson.desc" rows="5"></textarea>
              </div>

              <markdowneditor title="Notas do professor" content="selectedLesson.notes"></markdowneditor>

              <div class="row">
                <div class="col-lg-12">
                  <nav class="textcenter">
                      <div class="circle selected"></div>
                      <div class="circle"></div>
                      <button class="next btn btn-success" ng-click="active='units'">Continuar <i class="fa fa-angle-double-right"></i></button>
                  </nav>
                </div>
              </div>
            </div>
          </div>
          <div class="main-lesson-units row" ng-show="active=='units'">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-3">
                  <p><button class="btn btn-success btn-lg col-lg-12 uppercase" ng-click="addUnit()">adicionar unidade</button></p>
                  <ul class="units">
                    <li class="selected" ng-repeat="unit in selectedLesson.units">
                      <div class="row">
                        <div class="col-lg-1"><i class="icon-reorder"></i></div>
                        <div class="col-lg-8">
                            <a href="" ng-click="selectUnit($index)" ng-if="unit.title">{{unit.title}}</a>
                            <a href="" ng-click="selectUnit($index)" ng-if="!unit.title">Unidade {{$index+1}}</a>
                        </div>
                        <div class="col-lg-2 textright" ng-click="deleteUnit($index)"><i class="icon-remove alignright"></i></div>
                      </div>
                    </li>
                  </ul>
                </div>
                <div class="col-lg-9">
                  <div class="page-header top">
                    <h3 class="top">{{selectedUnit().title}}</h3>
                  </div>

                  <div class="form-group">
                    <label class="control-label">Título da unidade</label>
                    <input type="text" class="form-control unit-title" placeholder="Nome para a unidade"
                           ng-model="selectedUnit().title">
                  </div>

                  <div class="form-group">
                    <label class="control-label">Vídeo name</label>
                    <input type="text" class="form-control video-url" placeholder="http://www.youtube.com/watch?v="
                           ng-model="selectedUnit().video.name">
                  </div>

                  <div class="form-group">
                    <label class="control-label">Vídeo ID</label>
                    <input type="text" class="form-control video-url" placeholder="http://www.youtube.com/watch?v="
                           ng-model="selectedUnit().video.youtube_id">
                  </div>

                  <markdowneditor title="Saiba mais" content="selectedUnit().side_notes"></markdowneditor>

                  <div class="form-group">
                    <label class="control-label">Atividade</label>
                    <p class="{{activity().type}}">
                      <button ng-click="changeTypeTo('simplechoice')"
                              class="{{typeIs('simplechoice')?'active':''}} btn btn-sm btn-default">Escolha simples
                      </button>

                      <button ng-click="changeTypeTo('multiplechoice')"
                              class="{{typeIs('multiplechoice')?'active':''}} btn btn-sm btn-default">Múltipla escolha
                      </button>

                      <button ng-click="changeTypeTo('trueorfalse')"
                              class="{{typeIs('trueorfalse')?'active':''}} btn btn-sm btn-default">Verdadeiro ou falso
                      </button>

                      <button ng-click="changeTypeTo('relationship')"
                              class="{{typeIs('relationship')?'active':''}} btn btn-sm btn-default">Relacionamento
                      </button>

                      <button ng-click="changeTypeTo('html5')"
                              class="{{typeIs('html5')?'active':''}} btn btn-sm btn-default">HTML5
                      </button>

                    </p>
                  </div>

                  <div class="form-group singlechoice" ng-show="typeIs('simplechoice')">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="control-label col-lg-3">Pergunta</label>
                        <div class="col-lg-8 col-lg-offset-1">
                          <textarea class="form-control" placeholder="Digite a pergunta" ng-model="activity().data.question"></textarea>
                        </div>
                      </div>
                      <div class="form-group" ng-repeat="alt in activity().data.alternatives track by $index">
                        <label class="control-label col-lg-3">Alternativa {{$index+1}}</label>
                        <div class="col-lg-1">
                            <input type="radio" ng-model="activity().expected" value="{{$index}}" />
                        </div>
                        <div class="col-lg-8">
                            <input type="text" class="form-control" placeholder="Digite uma resposta"
                                 ng-model="activity().data.alternatives[$index]"/>
                        </div>
                      </div>
                    </div>
                    <button class="next btn" ng-click="addAlternative()">Adicionar resposta</button>
                  </div>

                  <div class="form-group multiplechoice" ng-show="typeIs('multiplechoice')">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="control-label col-lg-3">Pergunta</label>
                        <div class="col-lg-8 col-lg-offset-1">
                          <textarea class="form-control" placeholder="Digite a pergunta" ng-model="activity().data.question"></textarea>
                        </div>
                      </div>
                      <div class="form-group" ng-repeat="alt in activity().data.alternatives track by $index">
                        <label class="control-label col-lg-3">Alternativa {{$index+1}}</label>
                        <div class="col-lg-1">
                            <input type="checkbox" ng-model="activity().expected[$index]" />
                        </div>
                        <div class="col-lg-8">
                            <input type="text" class="form-control" placeholder="Digite uma resposta"
                                 ng-model="activity().data.alternatives[$index]"/>
                        </div>
                      </div>
                    </div>
                    <button class="next btn" ng-click="addAlternative()">Adicionar resposta</button>
                  </div>

                  <div class="form-group trueorfalse" ng-show="typeIs('trueorfalse')">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="control-label col-lg-3">Pergunta</label>

                        <div class="col-lg-1">
                            <span>&#9745;</span>
                        </div>
                        <div class="col-lg-1">
                            <span>&#9746;</span>
                        </div>

                        <div class="col-lg-7">
                          <textarea class="form-control" placeholder="Digite a pergunta" ng-model="activity().data.question"></textarea>
                        </div>
                      </div>
                      <div class="form-group" ng-repeat="alt in activity().data.alternatives track by $index">
                        <label class="control-label col-lg-3">Alternativa {{$index+1}}</label>
                        <div class="col-lg-1">
                            <input type="radio" ng-model="activity().expected[$index]" ng-value="true" />
                        </div>
                        <div class="col-lg-1">
                            <input type="radio" ng-model="activity().expected[$index]" ng-value="false" />
                        </div>
                        <div class="col-lg-7">
                            <input type="text" class="form-control" placeholder="Digite uma resposta"
                                 ng-model="activity().data.alternatives[$index]"/>
                        </div>
                      </div>
                    </div>
                    <button class="next btn" ng-click="addAlternative()">Adicionar resposta</button>
                  </div>

                  <!-- relationship -->
                  <div class="form-group relationship" ng-show="typeIs('relationship')">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="control-label col-lg-3">Pergunta</label>
                        <div class="col-lg-8 col-lg-offset-1">
                          <textarea class="form-control" placeholder="Digite a pergunta" ng-model="activity().data.question"></textarea>
                        </div>
                      </div>

                      <table class="form-group" style="width:100%">
                        <thead>
                            <tr>
                                <th style="width:44%">Coluna 1</th>
                                <th style="width:10%">Resposta</th>
                                <th style="width:44%">Coluna 2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="alt in (alts = activity().data.column1) track by $index">
                                <td><input tabindex="{{$index*2 + 1}}" class="form-control" type="text" ng-model="activity().data.column1[$index]" /></td>
                                <td><input tabindex="{{alts.length*2 + $index + 1}}" class="form-control" type="number" ng-model="activity().expected[$index]" /></td>
                                <td><input tabindex="{{$index*2 + 2}}" class="form-control" type="text" ng-model="activity().data.column2[$index]" /></td>
                            </tr>
                        </tbody>
                      </table>

                    </div>
                    <button class="next btn" ng-click="addAlternative()">Adicionar resposta</button>
                  </div>
                  <!-- relationship -->

                  <!-- div class="form-group trueorfalse">Verdadeiro ou falso</div-->
                  <!-- div class="form-group order">Ordenação</div-->
                  <div class="form-group html5" ng-show="typeIs('html5')">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="control-label col-lg-3">Texto dado</label>
                        <div class="col-lg-8 col-lg-offset-1">
                          <textarea class="form-control" placeholder="Digite os exemplos" ng-model="activity().data.data"></textarea>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="control-label col-lg-3">Resposta esperada</label>
                        <div class="col-lg-8 col-lg-offset-1">
                          <textarea class="form-control" placeholder="Digite o html completo da resposta esperada" ng-model="activity().expected.expected_answer"></textarea>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <nav class="textcenter">
                      <button class="prev btn btn-success" ng-click="active='content'"><i class="icon-fa-angle-double-left"></i> Voltar</button>
                      <div class="circle"></div>
                      <div class="circle selected"></div>
                      <button class="next btn btn-success disabled">Continuar <i class="fa fa-angle-double-right"></i></button>
                  </nav>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="selectedLesson.restore()">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="saveLesson()">Save changes</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endverbatim %}

</body>
</html>
