{% include "_forum_angular.html" %}
{% load timtec_markdown %}
{% load i18n %}

<script>
    window.course_id = {{ course.pk }};
    window.user_id = {{ user.pk }};
</script>

<section id="forum">
    
    <section id="forum-content" ng-controller="InlineForumCtrl">
        {% if question_form %}
            <div class="page-header-double">
                <h3><i class="fa fa-angle-double-right"></i> {% trans "Questions & Answers" %}</h3>
            </div>
            <!-- QUESTION FORM -->
            <div class="forum-form">
                <div class="form-group" ng-class="question_title_validation">
                    <input id="id-title" ng-model="new_question_title" name="title" type="text" class="form-control" placeholder="Qual é a sua dúvida?">
                </div>
                <div class="form-group text-editor">
                    <div class="wmd-panel" markdowneditor="true">
                        <div id="wmd-button-bar" class="js-button-bar"></div>
                        <div class="form-group" ng-class="question_text_validation">
                            <textarea id="wmd-input" ng-model="new_text" name="text" class="form-control" rows="4" placeholder="Descrição da sua dúvida"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div id="wmd-preview" class="wmd-panel wmd-preview"></div>
                </div>
                <div class="form-group bottom">
                    <div class="row">
                        <div class="col-lg-8 col-sm-8">
                            <small><a href="">Política de Perguntas e Respostas</a></small>
                        </div>
                        <div class="col-lg-4 col-sm-4 textright">
                            <input type="submit" class="btn btn-success" value="Enviar" ng-click="new_question()">
                        </div>
                    </div>
                </div>
            </div>
            <!-- END QUESTION FORM -->
        {% endif %}
    
    
        {% verbatim angularjs %}
            <!-- QUESTIONS LIST-->
            <section class="questions clearfix">
                <div class="search-filter">
                    <div class="row">
                        <div class="col-lg-7 col-sm-7">
                            <div class="btn-group">
                                <button type="button" class="btn btn-info">{{ sort_label }}</button>
                                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-chevron-down"></i>
                                </button>
                                <ul class="dropdown-menu top">
                                    <li><a href="" ng-click="sortBy('votes')">Mais votadas</a></li>
                                    <li><a href="" ng-click="sortBy('date')">Mais recentes</a></li>
                                    <li><a href="" ng-click="sortBy('answers')">Mais respondidas</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-5 col-sm-5 textright">
                            <pagination ng-if="totalItems>itemsPerPage" on-select-page="changePageHandler(page)" max-size="5" items-per-page="itemsPerPage" boundary-links="true" total-items="totalItems" page="currentPage" class="pagination-sm top pointer" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>
                        </div>
                    </div>
                </div>
                <div ng-repeat="question in current_page_questions">
                    <article ng-if="!question.hidden" class="is-hidden">
                        <table>
                            <tr>
                                <td>
                                    <div class="stats">
                                        <p><span class="numbers-votes">{{question.votes}}</span>votos</p>
                                        <p><span class="numbers-answers">{{ question.answers.length }}</span>respostas</p>
                                    </div>
                                    <div ng-click="hide_question(question)" class="actions btn btn-danger btn-sm">Ocultar</div>
                                </td>
                                <td style="width:100%;">
                                    <div class="content">
                                        <h1 class="top"><a href="/forum/question/{{ question.slug }}">{{ question.title }}</a></h1>
                                        <div class="description" ng-bind-html="question.text|markdown|words:50"></div>
                                        <p class="author">Pergunta feita feita em <strong>{{ question.timestamp|date:"dd/MM/yy" }}</strong> por <a href="/profile/{{ question.username }}">{{ question.username }}</a>.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                        <div class="clear why-hidden">
                            <h1>Entenda porque sua pergunta foi ocultada</h1>
                            <div class="content">
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras consectetur arcu sem, non auctor tellus bibendum vel. Maecenas gravida dictum orci, eu sollicitudin augue dignissim accumsan. Suspendisse ac vulputate eros. Aenean volutpat a orci et condimentum. In vel molestie nibh, ut congue lorem. Proin eu augue ante. Maecenas tristique lectus vel neque convallis luctus. Suspendisse potenti. Suspendisse lobortis ante pretium rutrum fermentum. Sed ac risus sed purus posuere cursus at vel est. Integer felis ligula, vulputate et semper quis, dictum sed augue.</p>
                                <p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nulla facilisi. Integer sem tellus, condimentum eu iaculis ut, adipiscing rhoncus urna. Duis et bibendum dui. Ut porttitor luctus neque. Praesent sit amet augue non ipsum rutrum rutrum ac fermentum orci. Mauris varius arcu ipsum, eu pharetra nunc rhoncus ut. Morbi nec ante sed orci aliquet vehicula non nec magna. Aliquam placerat metus sit amet mi malesuada, a ultrices nunc tempus. Suspendisse nec sagittis dolor.</p>
                            </div>
                        </div>
                    </article>
                </div>
            </section>
            <!-- QUESTIONS LIST-->
        {% endverbatim angularjs %}
    </section>
</section>
